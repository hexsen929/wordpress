$(function(){$(".links-card ul.list-inline img").each(function(){var t;""==$(this).attr("data-src")&&(t=$(this).closest("a").attr("href"))&&!t.includes("/go/")&&(t="https://api.hexsen.com/api/favicon.php?url="+t,$(this).attr("src",t))}),$(document).on("click",".sm",function(){var t=$(this);{var a,n,r;return t.hasClass("private_now")?notyf("您之前已设过私密评论","warning"):(t.addClass("private_now"),a=t.data("idp"),n=t.data("actionp"),r=t.children(".has_set_private"),t={action:"mrhe_private",p_id:a,p_action:n},$.post("/wp-admin/admin-ajax.php",t,function(t){r.html(t)})),!1}})}),$(function(){if($("body").hasClass("single")){const r=_win.views;var t=$(".px12-sm.muted-2-color.text-ellipsis span, .forum-article-meta .meta-left span").last();const e=$('<span id="Mrhe_Baidu_Record"> 正在检测百度是否收录</span>').appendTo(t),i=(t,a)=>{e.css("color",t).html(a)},o=t=>{t={status:t,timestamp:Date.now()};localStorage.setItem("baidu_record_"+r,JSON.stringify(t))};(async()=>{var t=(()=>{var t=localStorage.getItem("baidu_record_"+r);if(t)try{return JSON.parse(t)}catch(t){}return null})();if(t){var{status:t,timestamp:a}=t,n=Date.now();if("recorded"===t)return!i("#67C23A"," 已收录");if("submitted"===t&&n-a<864e5)return!i("#67C23A"," 已自动提交")}t=await(async()=>{try{return(await $.ajax({url:_win.ajax_url,type:"POST",dataType:"json",data:{action:"mrhe_baidu_record",push:r}})).data}catch(t){return console.error("Error fetching Baidu record:",t),!1}})();"已收录"===t?(i("#67C23A"," 已收录"),o("recorded")):"未收录"===t?_mrhe.BAIDU_PUSH?(i("#E6A23C"," 未收录，推送中..."),(n=await(async()=>{try{return await $.ajax({url:_win.ajax_url,type:"POST",dataType:"json",data:{action:"mrhe_baidu_push",push:r}})}catch(t){return{error:!0,message:" 推送服务暂不可用"}}})()).error?i("#F56C6C",n.msg||" 推送失败"):"over quota"===(a=n.data||{}).message?i("#F56C6C"," 推送额度不足！"):a.error?i("#F56C6C",a.message||" 推送失败"):(i("#67C23A"," 推送成功！"),o("submitted"))):(n="https://ziyuan.baidu.com/linksubmit/url?sitename="+encodeURI(window.location.origin+window.location.pathname),e.html(`<a target="_blank" href="${n}" rel="noopener noreferrer nofollow" style="color: #F56C6C"> 未收录，提交收录</a>`)):i("#F56C6C"," "+t)})()}}),$(function(){function t(){function r(n){$.getJSON(n.url).done(function(t){var a;(t=function(a){try{{var n=a;var r="ip";let t=n;for(const e of r.split(".")){if(!(t&&"object"==typeof t&&e in t))return null;t=t[e]}return t;return}}catch(t){return null}}(t))?(a=t,$("#commentform #submit").click(function(){$.post(_win.ajax_url,{action:"update_comment_ip",ip:a},function(t){})})):(t=window._mrhe.IP_APIS.indexOf(n)+1)<window._mrhe.IP_APIS.length&&r(window._mrhe.IP_APIS[t])}).fail(function(t){console.warn("API请求失败:",t);t=window._mrhe.IP_APIS.indexOf(n)+1;t<window._mrhe.IP_APIS.length&&r(window._mrhe.IP_APIS[t])})}$("#commentform").length&&window._mrhe.IP_APIS&&window._mrhe.IP_APIS&&0<window._mrhe.IP_APIS.length&&r(window._mrhe.IP_APIS[0])}$(document).ready(function(){t()})});